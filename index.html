<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Miltton Mobile</title>
    <!-- Estä indeksointi -->
    <meta name="robots" content="noindex, nofollow">
    <meta name="googlebot" content="noindex, nofollow">
    <style>
        * {
            margin: 0;
            padding: 0; 
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background-color: #ffffff;
            color: #000000;
            line-height: 1.6;
        }

        /* Header */
        header {
            background-color: #000000;
            padding: 20px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            color: #ffffff;
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        /* Main content container */
        main {
            max-width: 100%;
            min-height: calc(100vh - 140px);
        }

        /* Module container */
        .modules-container {
            padding: 0;
        }

        .module {
            padding: 30px 20px;
            border-bottom: 1px solid #e0e0e0;
        }

        /* Article module */
        .module-article {
            background-color: #ffffff;
        }

        .module-article h1 {
            font-size: 32px;
            margin-bottom: 16px;
            color: #000000;
            line-height: 1.2;
        }

        .module-article h2 {
            font-size: 28px;
            margin-bottom: 16px;
            color: #000000;
        }

        .module-article p {
            font-size: 16px;
            color: #333333;
            margin-bottom: 12px;
        }

        .module-article .lead {
            font-size: 18px;
            line-height: 1.7;
        }

        .module-article .tag {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: #000000;
            color: #ffffff;
            border-radius: 999px;
            font-size: 14px;
            margin-bottom: 16px;
        }

        .module-article .tag .spot {
            width: 10px;
            height: 10px;
            background: #E4F030;
            border-radius: 2px;
        }

        .module-image {
    padding: 0;
    background-color: #000000; /* Musta tausta */
    min-height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.module-image img {
    width: 100%;
    height: auto;
    display: block;
    object-fit: contain; /* contain näyttää koko kuvan */
}

        .module-video {
            padding: 0;
            background-color: #000000;
            min-height: 200px;
        }
.video-wrapper {
    position: relative;
    padding-bottom: 56.25%; /* 16:9 aspect ratio */
    height: 0;
    overflow: hidden;
}

.video-wrapper-vertical {
    position: relative;
    padding-bottom: 177.78%; /* 9:16 aspect ratio (pysty) */
    height: 0;
    overflow: hidden;
    max-width: 400px; /* Rajoittaa leveyttä mobiilissa */
    margin: 0 auto; /* Keskittää */
}

.video-wrapper-vertical iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 0;
}

.video-wrapper iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 0;
}
        .module-prompt {
            background-color: #E4F030;
        }

     .embed-wrapper {
    position: relative;
    width: 100%;
    height: 1200px; /* Kiinteä korkeus lomakkeelle */
    overflow: hidden;
}

.embed-wrapper iframe {
    width: 100%;
    height: 100%;
    border: 0;
}

/* Mobiilille pienempi */
@media (max-width: 560px) {
    .embed-wrapper {
        height: 990px;
    }

        /* Accent colors */
        .accent-neon {
            background-color: #E4F030;
        }

        .accent-orange {
            background-color: #EB5D29;
            color: #ffffff;
        }

        .accent-lilac {
            background-color: #8383D2;
            color: #ffffff;
        }

        .accent-green {
            background-color: #2D9E00;
            color: #ffffff;
        }

        /* Footer */
        footer {
            background-color: #000000;
            color: #ffffff;
            padding: 30px 20px;
            text-align: center;
        }

        footer p {
            font-size: 14px;
            opacity: 0.8;
        }

        /* Loading state */
        .loading {
            text-align: center;
            padding: 20px;
            color: #999999;
        }
/* Chatbot module */
.module-prompt {
    background-color: #000000; /* Musta tausta */
}

.module-prompt h2 {
    color: #ffffff; /* Valkoinen otsikko */
}

.module-prompt p {
    color: #ffffff; /* Valkoinen teksti */
}

.chatbot-container {
    margin-top: 20px;
}

.chat-messages {
    background: #ffffff;
    border-radius: 8px;
    padding: 20px;
    min-height: 200px;
    max-height: 400px;
    overflow-y: auto;
    margin-bottom: 16px;
}

.chat-message {
    margin-bottom: 16px;
    padding: 12px;
    border-radius: 8px;
}

.chat-message.user {
    background: #f0f0f0;
    margin-left: 20px;
}

.chat-message.assistant {
    background: #E4F030;
    margin-right: 20px;
}

.chat-message-label {
    font-weight: 700;
    font-size: 12px;
    text-transform: uppercase;
    margin-bottom: 4px;
    color: #666;
}

.chat-message-text {
    font-size: 16px;
    line-height: 1.5;
    color: #000;
}

.chat-input-wrapper {
    display: flex;
    gap: 8px;
}

.chat-input {
    flex: 1;
    padding: 12px 16px;
    border: 2px solid #E4F030; /* Neon-kehys */
    border-radius: 8px;
    font-size: 16px;
    font-family: inherit;
    background: #ffffff; /* Valkoinen tausta */
    color: #000000;
}

.chat-input:focus {
    outline: none;
    border-color: #E4F030;
    box-shadow: 0 0 0 2px rgba(228, 240, 48, 0.2);
}

.chat-button {
    padding: 12px 24px;
    background: #E4F030; /* Neon-nappi */
    color: #000;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
    font-family: inherit;
}

.chat-button:hover {
    background: #d4e020;
}

.chat-button:disabled {
    background: #666;
    cursor: not-allowed;
    color: #999;
}

.chat-loading {
    text-align: center;
    color: #666;
    padding: 12px;
    font-style: italic;
}
    </style>
</head>
<body>
    <header>
        <div class="logo">miltton</div>
    </header>

    <main>
        <div class="modules-container" id="modulesContainer">
            
            <!-- Article: Hero -->
            <div id="article-hero" class="module module-article accent-neon loading">
                Ladataan...
            </div>

            <!-- Picture: Fedobrave.jpg -->
            <!-- Image module -->
            <div class="module module-image">
            <img src="globe.png" alt="globe">
            </div>
            
            <!-- Article: State in a Smartphone -->
            <div id="article-state-in-smartphone" class="module module-article loading">
                Ladataan...
            </div>

            <!-- Article: Teknologiaekosysteemi -->
            <div id="article-ecosystem" class="module module-article loading">
                Ladataan...
            </div>

            <!-- Article: Unit.City -->
            <div id="article-unit-city" class="module module-article loading">
                Ladataan...
            </div>

            <!-- Video module: YouTube Shorts (pysty) -->
            <div class="module module-video">
            <div class="video-wrapper-vertical">
            <iframe 
            src="https://www.youtube.com/embed/wOmq2CSN_no" 
            title="YouTube video player" 
            frameborder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
            referrerpolicy="strict-origin-when-cross-origin" 
            allowfullscreen>
            </iframe>
    </div>
</div>

            <!-- Article: Brave1-tausta -->
            <div id="article-brave1-background" class="module module-article loading">
                Ladataan...
            </div>

            <!-- Article: Kenttädemot -->
            <div id="article-demo-clip" class="module module-article loading">
                Ladataan...
            </div>

<!-- Video module: YouTube embed -->
<div class="module module-video">
    <div class="video-wrapper">
        <iframe 
            src="https://www.youtube-nocookie.com/embed/FY1dEKmFvZQ?si=yw-VAkne1nwYNB5Z" 
            title="YouTube video player" 
            frameborder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
            referrerpolicy="strict-origin-when-cross-origin" 
            allowfullscreen>
        </iframe>
    </div>
</div>
            
            <!-- Article: Brave1 Market -->
            <div id="article-market" class="module module-article loading">
                Ladataan...
            </div>

            <!-- Picture: brave2.png -->
            <!-- Image module -->
            <div class="module module-image">
            <img src="brave2.png" alt="Brave1-katalogin etusivu">
            </div>

                 <!-- Picture: brave2.png -->
            <!-- Image module -->
            <div class="module module-image">
            <img src="brave3.png" alt="Brave1-katalogi droonitutkat">
            </div>
            
            <!-- Article: Toimintamalli -->
            <div id="article-model" class="module module-article loading">
                Ladataan...
            </div>

            <!-- Article: Merkitys -->
            <div id="article-significance" class="module module-article accent-neon loading">
                Ladataan...
            </div>

            <!-- Picture: brave2.png -->
            <!-- Image module -->
            <div class="module module-image">
            <img src="water.png" alt="vesidrooni">
            </div>
            
            <!-- Embed module: Microsoft Forms -->
           <div class="module module-embed">
           <div class="embed-wrapper">
           <iframe 
            src="https://forms.office.com/e/5ZCiMnnu5x?embed=true" 
            frameborder="0" 
            marginwidth="0" 
            marginheight="0" 
            allowfullscreen 
            webkitallowfullscreen 
            mozallowfullscreen 
            msallowfullscreen>
            </iframe>
            </div>

               <!-- Chatbot module -->
            <div id="article-chatbot" class="module module-prompt">
            <h2>Kysy Brave1-ohjelmasta tekoälyltä</h2>
            <p>AI vastaa tarkempiin kysymyksiin:</p>
    
            <div class="chatbot-container">
            <div id="chatMessages" class="chat-messages"></div>
        
            <div class="chat-input-wrapper">
            <input 
                type="text" 
                id="chatInput" 
                placeholder="Kirjoita kysymyksesi tähän..." 
                class="chat-input"
            >
            <button id="chatSend" class="chat-button">Lähetä</button>
        </div>
    </div>
</div>
            <!-- Article: Yhteystiedot -->
            <div id="article-contact" class="module module-article accent-neon loading">
                Ladataan...
            </div>

        </div>
    </main>

    <footer>
        <div class="logo" style="margin-bottom: 10px;">miltton</div>
        <p>&copy; 2025 Miltton</p>
    </footer>

    <script>
        // Load articles data
        let articlesData = null;

        async function loadArticlesData() {
            try {
                const response = await fetch('articles.json');
                articlesData = await response.json();
                console.log('Articles loaded:', articlesData);
                renderAllArticles();
            } catch (error) {
                console.error('Error loading articles:', error);
            }
        }

        // Render specific article by ID
        function renderArticle(articleId) {
            if (!articlesData) return;

            const article = articlesData.modules.find(m => m.id === articleId);
            if (!article) {
                console.error('Article not found:', articleId);
                return;
            }

            const container = document.getElementById(`article-${articleId}`);
            if (!container) {
                console.error('Container not found for:', articleId);
                return;
            }

            let html = '';

            // Add tag if exists
            if (article.tag) {
                html += `<span class="tag"><span class="spot"></span> ${article.tag}</span>`;
            }

            // Add title (h1 for hero, h2 for others)
            if (article.id === 'hero') {
                html += `<h1>${article.title}</h1>`;
            } else {
                html += `<h2>${article.title}</h2>`;
            }

            // Add content (split by double newlines for paragraphs)
            const paragraphs = article.content.split('\n\n');
            paragraphs.forEach((para, index) => {
                const className = (article.id === 'hero' && index === 0) ? 'lead' : '';
                html += `<p class="${className}">${para.replace(/\n/g, '<br>')}</p>`;
            });

            container.innerHTML = html;
            container.classList.remove('loading');
        }

        // Render all articles in order
        function renderAllArticles() {
            renderArticle('hero');
            renderArticle('state-in-smartphone');
            renderArticle('ecosystem');
            renderArticle('unit-city');
            renderArticle('brave1-background');
            renderArticle('demo-clip');
            renderArticle('market');
            renderArticle('model');
            renderArticle('significance');
            renderArticle('contact');
            renderArticle('forms');
        }

        // Initialize on page load
        loadArticlesData();

        // Chatbot functionality
let chatContext = null;

// Load chatbot context
async function loadChatContext() {
    try {
        const response = await fetch('chatbot-context.json');
        chatContext = await response.json();
        console.log('Chatbot context loaded');
    } catch (error) {
        console.error('Error loading chatbot context:', error);
    }
}

// Send message to AI
async function sendMessage() {
    const input = document.getElementById('chatInput');
    const messagesContainer = document.getElementById('chatMessages');
    const sendButton = document.getElementById('chatSend');
    
    const userMessage = input.value.trim();
    if (!userMessage) return;
    
    // Disable input
    input.disabled = true;
    sendButton.disabled = true;
    
    // Add user message
    addMessage('user', userMessage);
    input.value = '';
    
    // Add loading indicator
    const loadingDiv = document.createElement('div');
    loadingDiv.className = 'chat-loading';
    loadingDiv.textContent = 'AI vastaa...';
    loadingDiv.id = 'loading';
    messagesContainer.appendChild(loadingDiv);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
    
    try {
        // Prepare message with context
        const contextMessage = chatContext 
        ? `${chatContext.system}\n\nKonteksti: ${chatContext.context}\n\nKysymys: ${userMessage}\n\nMuista: Älä esitä kysymyksiä lopussa.`
        : userMessage;
        
       // Call Cloudflare Worker
    const response = await fetch('https://ai.miltton-ai.workers.dev', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify({
        model: 'claude-3-haiku-20240307',
        max_tokens: 1024,
        system: chatContext?.system || 'Vastaa suomeksi.',
        messages: [
            {
                role: 'user',
                content: chatContext?.context 
                    ? `Konteksti:\n${chatContext.context}\n\nKysymys: ${userMessage}`
                    : userMessage
            }
        ]
    })
});

const data = await response.json();

// Remove loading
document.getElementById('loading')?.remove();

// Add AI response
if (data.content && data.content[0] && data.content[0].text) {
    addMessage('assistant', data.content[0].text);
} else if (data.error) {
    addMessage('assistant', 'Virhe: ' + (data.error.message || JSON.stringify(data.error)));
}
        
    } catch (error) {
        document.getElementById('loading')?.remove();
        addMessage('assistant', 'Virhe yhteydessä AI:hin: ' + error.message);
    }
    
    // Re-enable input
    input.disabled = false;
    sendButton.disabled = false;
    input.focus();
}

// Add message to chat
function addMessage(role, text) {
    const messagesContainer = document.getElementById('chatMessages');
    
    const messageDiv = document.createElement('div');
    messageDiv.className = `chat-message ${role}`;
    
    const labelDiv = document.createElement('div');
    labelDiv.className = 'chat-message-label';
    labelDiv.textContent = role === 'user' ? 'Sinä' : 'AI';
    
    const textDiv = document.createElement('div');
    textDiv.className = 'chat-message-text';
    textDiv.textContent = text;
    
    messageDiv.appendChild(labelDiv);
    messageDiv.appendChild(textDiv);
    messagesContainer.appendChild(messageDiv);
    
    // Scroll to bottom
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

// Event listeners for chatbot
document.addEventListener('DOMContentLoaded', () => {
    loadChatContext();
    
    const sendButton = document.getElementById('chatSend');
    const input = document.getElementById('chatInput');
    
    if (sendButton) {
        sendButton.addEventListener('click', sendMessage);
    }
    
    if (input) {
        input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    }
});
    </script>
</body>
</html>
